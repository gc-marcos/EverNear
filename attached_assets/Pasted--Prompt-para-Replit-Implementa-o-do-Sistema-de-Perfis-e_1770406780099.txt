# Prompt para Replit - Implementa√ß√£o do Sistema de Perfis e V√≠nculo

```
CONTEXTO:
Voc√™ est√° revisando um aplicativo Android existente em Java. O app J√Å POSSUI telas e funcionalidades b√°sicas implementadas. Sua tarefa √© APENAS revisar o c√≥digo existente e implementar/complementar o sistema de sele√ß√£o de perfil de usu√°rio e v√≠nculo entre paciente e cuidador.

IMPORTANTE: Este c√≥digo ser√° testado no Android Studio, n√£o no Replit. Gere c√≥digo completo e funcional.

---

## üéØ O QUE VOC√ä DEVE FAZER:

### 1Ô∏è‚É£ REVISAR O C√ìDIGO EXISTENTE
Analise o projeto e identifique:
- Quais activities j√° existem
- Qual estrutura de navega√ß√£o est√° implementada
- Quais integra√ß√µes com Firebase j√° est√£o configuradas
- O que est√° faltando para implementar o fluxo descrito abaixo

### 2Ô∏è‚É£ IMPLEMENTAR APENAS O QUE FALTA

---

## üìã FUNCIONALIDADES REQUERIDAS

### A) TELA DE SELE√á√ÉO DE PERFIL (Primeira tela do app)

**O que implementar:**
- Activity que pergunta: "Voc√™ √© Paciente ou Cuidador?"
- Dois bot√µes:
  - `btn_patient` (bot√£o "Sou Paciente")
  - `btn_caregiver` (bot√£o "Sou Cuidador")
- Ao clicar em qualquer bot√£o:
  - Armazenar temporariamente a escolha (tipo de usu√°rio)
  - Navegar para a tela de login
  - Passar o tipo de usu√°rio para a LoginActivity

**Verifica√ß√£o importante:**
- Se o usu√°rio j√° estiver logado (FirebaseAuth.getCurrentUser() != null), pular essa tela
- Buscar o tipo de usu√°rio no Firestore e redirecionar para o dashboard correto

---

### B) MODIFICAR/CRIAR LoginActivity

**O que implementar:**

1. **Receber o tipo de usu√°rio** da tela anterior via Intent
2. **Modo Login**: Permitir login com email/senha
3. **Modo Cadastro**: Coletar nome + email + senha
4. **Ao cadastrar com sucesso**, salvar no Firestore:

```java
// Estrutura de dados para PACIENTE:
{
    "nome": "Jo√£o Silva",
    "email": "joao@email.com",
    "tipo": "paciente",
    "codigoVinculo": "ABC123", // GERAR C√ìDIGO DE 6 CARACTERES
    "cuidadorVinculado": null  // null at√© vincular
}

// Estrutura de dados para CUIDADOR:
{
    "nome": "Maria Santos",
    "email": "maria@email.com",
    "tipo": "cuidador",
    "pacientesVinculados": []  // Array vazio inicialmente (m√°x 3 pacientes)
}
```

5. **Fun√ß√£o para gerar c√≥digo de v√≠nculo** (apenas para pacientes):
   - 6 caracteres alfanum√©ricos aleat√≥rios (A-Z, 0-9)
   - Exemplo: "A3X7K9"

6. **Ap√≥s login/cadastro bem-sucedido**:
   - Buscar tipo de usu√°rio no Firestore
   - Redirecionar para DashboardPacienteActivity OU DashboardCuidadorActivity

---

### C) DASHBOARD DO PACIENTE

**O que implementar:**

1. **Exibir informa√ß√µes do paciente:**
   - Nome do paciente
   - C√≥digo de v√≠nculo (grande e destacado)
   - Status do v√≠nculo:
     - Se `cuidadorVinculado == null`: "Compartilhe este c√≥digo com seu cuidador"
     - Se vinculado: "Vinculado a: [Nome do Cuidador]"

2. **Layout sugerido:**
```xml
- TextView: "Ol√°, [Nome do Paciente]"
- CardView com:
  - TextView: "Seu C√≥digo de V√≠nculo:"
  - TextView (grande): "ABC123"
  - Button: "Compartilhar C√≥digo" (abre share do Android)
- TextView: Status do v√≠nculo
```

---

### D) DASHBOARD DO CUIDADOR

**O que implementar:**

1. **Se√ß√£o de Vincular Novo Paciente:**
   - EditText para digitar c√≥digo (6 caracteres)
   - Button "Vincular Paciente"

2. **L√≥gica de vincula√ß√£o:**
```java
// Ao clicar em Vincular:
1. Buscar no Firestore um paciente com codigoVinculo == codigo_digitado
2. Verificar se o cuidador j√° tem 3 pacientes vinculados (limite m√°ximo)
3. Se encontrou o paciente E tem espa√ßo:
   - Adicionar UID do paciente no array "pacientesVinculados" do cuidador
   - Atualizar campo "cuidadorVinculado" do paciente com UID do cuidador
4. Mostrar mensagem de sucesso
```

3. **Lista de Pacientes Vinculados:**
   - RecyclerView mostrando os pacientes vinculados
   - Cada item exibe: Nome do paciente + bot√£o "Desvincular"

---

## üî• ESTRUTURA FIRESTORE (use exatamente assim)

### Cole√ß√£o: `users`
```
users
 ‚îú‚îÄ‚îÄ {uid_paciente_1}
 ‚îÇ    ‚îú‚îÄ‚îÄ nome: "Jo√£o Silva"
 ‚îÇ    ‚îú‚îÄ‚îÄ email: "joao@email.com"
 ‚îÇ    ‚îú‚îÄ‚îÄ tipo: "paciente"
 ‚îÇ    ‚îú‚îÄ‚îÄ codigoVinculo: "ABC123"
 ‚îÇ    ‚îî‚îÄ‚îÄ cuidadorVinculado: "{uid_cuidador}" ou null
 ‚îÇ
 ‚îî‚îÄ‚îÄ {uid_cuidador_1}
      ‚îú‚îÄ‚îÄ nome: "Maria Santos"
      ‚îú‚îÄ‚îÄ email: "maria@email.com"
      ‚îú‚îÄ‚îÄ tipo: "cuidador"
      ‚îî‚îÄ‚îÄ pacientesVinculados: ["{uid_paciente_1}", "{uid_paciente_2}"]
```

---

## üîß C√ìDIGO JAVA QUE VOC√ä DEVE FORNECER

Gere c√≥digo completo para:

1. **SelecaoPerfilActivity.java** (se n√£o existir)
2. **LoginActivity.java** (modifica√ß√µes necess√°rias)
3. **DashboardPacienteActivity.java** (funcionalidade de exibir c√≥digo)
4. **DashboardCuidadorActivity.java** (funcionalidade de vincular)
5. **Classe Helper:** `FirebaseHelper.java` com m√©todos:
   - `gerarCodigoVinculo()`
   - `salvarUsuario(uid, nome, email, tipo)`
   - `vincularPacienteCuidador(uidCuidador, codigoPaciente)`
   - `buscarPacientePorCodigo(codigo, callback)`
   - `verificarLimitePacientes(uidCuidador, callback)`

---

## ‚úÖ VALIDA√á√ïES OBRIGAT√ìRIAS

1. **Limite de pacientes:** Cuidador pode ter no m√°ximo 3 pacientes
2. **C√≥digo √∫nico:** Verificar se c√≥digo gerado j√° n√£o existe no Firestore
3. **C√≥digo v√°lido:** Ao vincular, verificar se c√≥digo existe e se paciente ainda n√£o tem cuidador
4. **Persist√™ncia:** Ao reabrir app, usu√°rio logado deve ir direto para seu dashboard

---

## üìù OBSERVA√á√ïES IMPORTANTES

- Use **Firebase Authentication** para login/cadastro
- Use **Firebase Firestore** para armazenar perfis e v√≠nculos
- N√ÉO implemente FCM ou Realtime Database agora (ser√° feito depois)
- Todos os m√©todos Firebase devem ter tratamento de erro com Toast
- Use ProgressDialog ou ProgressBar durante opera√ß√µes ass√≠ncronas
- C√≥digo deve ser comentado e bem estruturado

---

## üöÄ ENTREGA ESPERADA

Forne√ßa:
1. C√≥digo Java completo de cada classe mencionada
2. Layouts XML necess√°rios (se precisar criar novos)
3. Coment√°rios explicando l√≥gica principal
4. Lista de depend√™ncias do Firebase que devem estar no build.gradle

---

LEMBRE-SE: Revise o c√≥digo existente primeiro e implemente APENAS o que falta para completar esse fluxo de perfis e v√≠nculo. N√£o recrie funcionalidades j√° existentes.
```

---

**Como usar este prompt:**
1. Cole no Replit Agent
2. Ele vai analisar seu projeto
3. Vai identificar o que falta
4. Vai gerar apenas o c√≥digo necess√°rio para completar o sistema de perfis e v√≠nculo

Esse prompt √© objetivo e focado apenas na parte que voc√™ precisa implementar agora! üéØ